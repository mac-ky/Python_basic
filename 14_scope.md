# 名前空間とスコープ

## 名前空間
名前とオブジェクトを対応付けること．多くは辞書で対応付けられている．\
組み込み関数のglobals関数で現在のモジュールの名前空間を取得することができる．


```python
a = 2
x = 10

def exponential(a, x):
    return a ** x

print(globals())
```

    {'__name__': '__main__', '__doc__': 'Automatically created module for IPython interactive environment', '__package__': None, '__loader__': None, '__spec__': None, '__builtin__': <module 'builtins' (built-in)>, '__builtins__': <module 'builtins' (built-in)>, '_ih': ['', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (T < F)\nL = [5, 3.14, "Hello python!", (T < F)]\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (I < F)\nL = [5, 3.14, "Hello python!", (I < F)]\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\n\nprint(globals())'], '_oh': {1: '{"dataframes": [], "user": "uedamakishi"}', 2: '{"dataframes": [], "user": "uedamakishi"}', 3: '{"dataframes": [], "user": "uedamakishi"}', 4: '{"dataframes": [], "user": "uedamakishi"}', 5: '{"dataframes": [], "user": "uedamakishi"}', 6: '{"dataframes": [], "user": "uedamakishi"}', 7: '{"dataframes": [], "user": "uedamakishi"}', 8: '{"dataframes": [], "user": "uedamakishi"}', 9: '{"dataframes": [], "user": "uedamakishi"}', 10: '{"dataframes": [], "user": "uedamakishi"}', 11: '{"dataframes": [], "user": "uedamakishi"}', 13: '{"dataframes": [], "user": "uedamakishi"}', 15: '{"dataframes": [], "user": "uedamakishi"}', 16: '{"dataframes": [], "user": "uedamakishi"}', 18: '{"dataframes": [], "user": "uedamakishi"}'}, '_dh': [PosixPath('/Users/uedamakishi/github/Python_basic')], 'In': ['', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (T < F)\nL = [5, 3.14, "Hello python!", (T < F)]\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (I < F)\nL = [5, 3.14, "Hello python!", (I < F)]\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\n\nprint(globals())'], 'Out': {1: '{"dataframes": [], "user": "uedamakishi"}', 2: '{"dataframes": [], "user": "uedamakishi"}', 3: '{"dataframes": [], "user": "uedamakishi"}', 4: '{"dataframes": [], "user": "uedamakishi"}', 5: '{"dataframes": [], "user": "uedamakishi"}', 6: '{"dataframes": [], "user": "uedamakishi"}', 7: '{"dataframes": [], "user": "uedamakishi"}', 8: '{"dataframes": [], "user": "uedamakishi"}', 9: '{"dataframes": [], "user": "uedamakishi"}', 10: '{"dataframes": [], "user": "uedamakishi"}', 11: '{"dataframes": [], "user": "uedamakishi"}', 13: '{"dataframes": [], "user": "uedamakishi"}', 15: '{"dataframes": [], "user": "uedamakishi"}', 16: '{"dataframes": [], "user": "uedamakishi"}', 18: '{"dataframes": [], "user": "uedamakishi"}'}, 'get_ipython': <bound method InteractiveShell.get_ipython of <ipykernel.zmqshell.ZMQInteractiveShell object at 0x107eb7df0>>, 'exit': <IPython.core.autocall.ZMQExitAutocall object at 0x107f00700>, 'quit': <IPython.core.autocall.ZMQExitAutocall object at 0x107f00700>, 'open': <function open at 0x106c1e830>, '_': '{"dataframes": [], "user": "uedamakishi"}', '__': '{"dataframes": [], "user": "uedamakishi"}', '___': '{"dataframes": [], "user": "uedamakishi"}', '__session__': '/Users/uedamakishi/github/Python_basic/Untitled.ipynb', 'sys': <module 'sys' (built-in)>, 'os': <module 'os' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/os.py'>, 're': <module 're' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/re.py'>, 'json': <module 'json' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/json/__init__.py'>, 'Path': <class 'pathlib.Path'>, 'Annotated': <class 'typing.Annotated'>, 'Any': typing.Any, 'Callable': typing.Callable, 'ClassVar': typing.ClassVar, 'Concatenate': typing.Concatenate, 'Final': typing.Final, 'ForwardRef': <class 'typing.ForwardRef'>, 'Generic': <class 'typing.Generic'>, 'Literal': typing.Literal, 'Optional': typing.Optional, 'ParamSpec': <class 'typing.ParamSpec'>, 'Protocol': <class 'typing.Protocol'>, 'Tuple': typing.Tuple, 'Type': typing.Type, 'TypeVar': <class 'typing.TypeVar'>, 'Union': typing.Union, 'AbstractSet': typing.AbstractSet, 'ByteString': typing.ByteString, 'Container': typing.Container, 'ContextManager': typing.ContextManager, 'Hashable': typing.Hashable, 'ItemsView': typing.ItemsView, 'Iterable': typing.Iterable, 'Iterator': typing.Iterator, 'KeysView': typing.KeysView, 'Mapping': typing.Mapping, 'MappingView': typing.MappingView, 'MutableMapping': typing.MutableMapping, 'MutableSequence': typing.MutableSequence, 'MutableSet': typing.MutableSet, 'Sequence': typing.Sequence, 'Sized': typing.Sized, 'ValuesView': typing.ValuesView, 'Awaitable': typing.Awaitable, 'AsyncIterator': typing.AsyncIterator, 'AsyncIterable': typing.AsyncIterable, 'Coroutine': typing.Coroutine, 'Collection': typing.Collection, 'AsyncGenerator': typing.AsyncGenerator, 'AsyncContextManager': typing.AsyncContextManager, 'Reversible': typing.Reversible, 'SupportsAbs': <class 'typing.SupportsAbs'>, 'SupportsBytes': <class 'typing.SupportsBytes'>, 'SupportsComplex': <class 'typing.SupportsComplex'>, 'SupportsFloat': <class 'typing.SupportsFloat'>, 'SupportsIndex': <class 'typing.SupportsIndex'>, 'SupportsInt': <class 'typing.SupportsInt'>, 'SupportsRound': <class 'typing.SupportsRound'>, 'ChainMap': typing.ChainMap, 'Counter': typing.Counter, 'Deque': typing.Deque, 'Dict': typing.Dict, 'DefaultDict': typing.DefaultDict, 'List': typing.List, 'OrderedDict': typing.OrderedDict, 'Set': typing.Set, 'FrozenSet': typing.FrozenSet, 'NamedTuple': <function NamedTuple at 0x104ad7760>, 'TypedDict': <function TypedDict at 0x104ad7910>, 'Generator': typing.Generator, 'BinaryIO': <class 'typing.BinaryIO'>, 'IO': <class 'typing.IO'>, 'Match': typing.Match, 'Pattern': typing.Pattern, 'TextIO': <class 'typing.TextIO'>, 'AnyStr': ~AnyStr, 'cast': <function cast at 0x104ad6830>, 'final': <function final at 0x104ad6e60>, 'get_args': <function get_args at 0x104ad6b00>, 'get_origin': <function get_origin at 0x104ad6a70>, 'get_type_hints': <function get_type_hints at 0x104ad6950>, 'is_typeddict': <function is_typeddict at 0x104ad6b90>, 'NewType': <class 'typing.NewType'>, 'no_type_check': <function no_type_check at 0x104ad6c20>, 'no_type_check_decorator': <function no_type_check_decorator at 0x104ad6cb0>, 'NoReturn': typing.NoReturn, 'overload': <function overload at 0x104ad6dd0>, 'ParamSpecArgs': <class 'typing.ParamSpecArgs'>, 'ParamSpecKwargs': <class 'typing.ParamSpecKwargs'>, 'runtime_checkable': <function runtime_checkable at 0x104ad5fc0>, 'Text': <class 'str'>, 'TYPE_CHECKING': False, 'TypeAlias': typing.TypeAlias, 'TypeGuard': typing.TypeGuard, 'defaultdict': <class 'collections.defaultdict'>, '__msg': 'Imported sys, os, re, json, Path, defaultdict, and all modules of typing and rhoknp.', '__version__': '1.1.0', 'RegexSenter': <class 'rhoknp.processors.senter.RegexSenter'>, 'Jumanpp': <class 'rhoknp.processors.jumanpp.Jumanpp'>, 'KNP': <class 'rhoknp.processors.knp.KNP'>, 'KWJA': <class 'rhoknp.processors.kwja.KWJA'>, 'Document': <class 'rhoknp.units.document.Document'>, 'Sentence': <class 'rhoknp.units.sentence.Sentence'>, 'Clause': <class 'rhoknp.units.clause.Clause'>, 'Phrase': <class 'rhoknp.units.phrase.Phrase'>, 'BasePhrase': <class 'rhoknp.units.base_phrase.BasePhrase'>, 'Morpheme': <class 'rhoknp.units.morpheme.Morpheme'>, 'readline': <module 'readline' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/lib-dynload/readline.cpython-310-darwin.so'>, 'atexit': <module 'atexit' (built-in)>, '__hist': PosixPath('/Users/uedamakishi/.local/share/python/python_history'), 'write_history': <function write_history at 0x107fcac20>, '_i': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_ii': 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\nprint(globals())', '_iii': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_i1': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'getpass': <module 'getpass' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/getpass.py'>, 'hashlib': <module 'hashlib' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/hashlib.py'>, 'import_pandas_safely': <function import_pandas_safely at 0x117503d00>, '__pandas': <module 'pandas' from '/opt/homebrew/lib/python3.10/site-packages/pandas/__init__.py'>, 'is_data_frame': <function is_data_frame at 0x1175037f0>, 'dataframe_columns': <function dataframe_columns at 0x1175029e0>, 'dtypes_str': <function dtypes_str at 0x117502290>, 'dataframe_hash': <function dataframe_hash at 0x107fcb400>, 'get_dataframes': <function get_dataframes at 0x107fcb520>, '_1': '{"dataframes": [], "user": "uedamakishi"}', '_i2': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_2': '{"dataframes": [], "user": "uedamakishi"}', '_i3': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_3': '{"dataframes": [], "user": "uedamakishi"}', '_i4': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_4': '{"dataframes": [], "user": "uedamakishi"}', '_i5': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_5': '{"dataframes": [], "user": "uedamakishi"}', '_i6': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_6': '{"dataframes": [], "user": "uedamakishi"}', '_i7': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_7': '{"dataframes": [], "user": "uedamakishi"}', '_i8': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_8': '{"dataframes": [], "user": "uedamakishi"}', '_i9': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_9': '{"dataframes": [], "user": "uedamakishi"}', '_i10': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_10': '{"dataframes": [], "user": "uedamakishi"}', '_i11': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_11': '{"dataframes": [], "user": "uedamakishi"}', '_i12': 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (T < F)\nL = [5, 3.14, "Hello python!", (T < F)]\n\nprint(globals())', 'I': 5, 'F': 3.14, 'St': 'Hello python!', '_i13': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_13': '{"dataframes": [], "user": "uedamakishi"}', '_i14': 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (I < F)\nL = [5, 3.14, "Hello python!", (I < F)]\n\nprint(globals())', 'B_01': False, 'L': [5, 3.14, 'Hello python!', False], '_i15': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_15': '{"dataframes": [], "user": "uedamakishi"}', '_i16': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_16': '{"dataframes": [], "user": "uedamakishi"}', '_i17': 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\nprint(globals())', 'a': 2, 'x': 10, 'exponential': <function exponential at 0x117503a30>, '_i18': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_18': '{"dataframes": [], "user": "uedamakishi"}', '_i19': 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\n\nprint(globals())'}


## スコープ
名前空間に対応付けされた名前を直接参照できる領域．\
ビルトインスコープ>グローバルスコープ>ローカルスコープの順に狭くなっていく．


```python
# 関数の中で定義した変数を関数の外から呼び出そうとするとエラーになる．
def greeting():
    morning = "おはよう"

print(morning)
```


    ---------------------------------------------------------------------------

    NameError                                 Traceback (most recent call last)

    Cell In[41], line 5
          2 def greeting():
          3     morning = "おはよう"
    ----> 5 print(morning)


    NameError: name 'morning' is not defined


## ビルトインスコープ
組み込み定数(True, False)や組み込み関数(print関数，max関数)などがこれにあたる．

## グローバルスコープ
1つのモジュール全体を含む．モジュール内のどこからでも参照できる，


```python
evening = "こんばんは"

def greeting():
    morning = "おはよう"
    print(evening)

print(evening)  # 関数の外から変数eveningを参照
greeting()  # 関数の中から変数eveningを参照
```

    こんばんは
    こんばんは



```python
evening = "こんばんは"

def greeting():
    morning = "おはよう"
    print(evening)

print(globals())  # 関数内で定義した変数morningは表示されない
```

    {'__name__': '__main__', '__doc__': 'Automatically created module for IPython interactive environment', '__package__': None, '__loader__': None, '__spec__': None, '__builtin__': <module 'builtins' (built-in)>, '__builtins__': <module 'builtins' (built-in)>, '_ih': ['', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (T < F)\nL = [5, 3.14, "Hello python!", (T < F)]\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (I < F)\nL = [5, 3.14, "Hello python!", (I < F)]\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'def greeting():\n    morning = "おはよう"\n\nprint(morning)', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(egvening)\n\nprint(egvening)\ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(evening)\ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(evening)  # 関数の外から変数eveningを参照\ngreeting()  # 関数の中から変数eveningを参照', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(globals())  # 関数内で定義した変数morningは表示されない'], '_oh': {1: '{"dataframes": [], "user": "uedamakishi"}', 2: '{"dataframes": [], "user": "uedamakishi"}', 3: '{"dataframes": [], "user": "uedamakishi"}', 4: '{"dataframes": [], "user": "uedamakishi"}', 5: '{"dataframes": [], "user": "uedamakishi"}', 6: '{"dataframes": [], "user": "uedamakishi"}', 7: '{"dataframes": [], "user": "uedamakishi"}', 8: '{"dataframes": [], "user": "uedamakishi"}', 9: '{"dataframes": [], "user": "uedamakishi"}', 10: '{"dataframes": [], "user": "uedamakishi"}', 11: '{"dataframes": [], "user": "uedamakishi"}', 13: '{"dataframes": [], "user": "uedamakishi"}', 15: '{"dataframes": [], "user": "uedamakishi"}', 16: '{"dataframes": [], "user": "uedamakishi"}', 18: '{"dataframes": [], "user": "uedamakishi"}', 20: '{"dataframes": [], "user": "uedamakishi"}', 21: '{"dataframes": [], "user": "uedamakishi"}', 23: '{"dataframes": [], "user": "uedamakishi"}', 24: '{"dataframes": [], "user": "uedamakishi"}', 25: '{"dataframes": [], "user": "uedamakishi"}', 26: '{"dataframes": [], "user": "uedamakishi"}', 27: '{"dataframes": [], "user": "uedamakishi"}', 28: '{"dataframes": [], "user": "uedamakishi"}', 29: '{"dataframes": [], "user": "uedamakishi"}', 31: '{"dataframes": [], "user": "uedamakishi"}', 33: '{"dataframes": [], "user": "uedamakishi"}', 35: '{"dataframes": [], "user": "uedamakishi"}', 37: '{"dataframes": [], "user": "uedamakishi"}'}, '_dh': [PosixPath('/Users/uedamakishi/github/Python_basic')], 'In': ['', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (T < F)\nL = [5, 3.14, "Hello python!", (T < F)]\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (I < F)\nL = [5, 3.14, "Hello python!", (I < F)]\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'def greeting():\n    morning = "おはよう"\n\nprint(morning)', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(egvening)\n\nprint(egvening)\ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(evening)\ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(evening)  # 関数の外から変数eveningを参照\ngreeting()  # 関数の中から変数eveningを参照', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(globals())  # 関数内で定義した変数morningは表示されない'], 'Out': {1: '{"dataframes": [], "user": "uedamakishi"}', 2: '{"dataframes": [], "user": "uedamakishi"}', 3: '{"dataframes": [], "user": "uedamakishi"}', 4: '{"dataframes": [], "user": "uedamakishi"}', 5: '{"dataframes": [], "user": "uedamakishi"}', 6: '{"dataframes": [], "user": "uedamakishi"}', 7: '{"dataframes": [], "user": "uedamakishi"}', 8: '{"dataframes": [], "user": "uedamakishi"}', 9: '{"dataframes": [], "user": "uedamakishi"}', 10: '{"dataframes": [], "user": "uedamakishi"}', 11: '{"dataframes": [], "user": "uedamakishi"}', 13: '{"dataframes": [], "user": "uedamakishi"}', 15: '{"dataframes": [], "user": "uedamakishi"}', 16: '{"dataframes": [], "user": "uedamakishi"}', 18: '{"dataframes": [], "user": "uedamakishi"}', 20: '{"dataframes": [], "user": "uedamakishi"}', 21: '{"dataframes": [], "user": "uedamakishi"}', 23: '{"dataframes": [], "user": "uedamakishi"}', 24: '{"dataframes": [], "user": "uedamakishi"}', 25: '{"dataframes": [], "user": "uedamakishi"}', 26: '{"dataframes": [], "user": "uedamakishi"}', 27: '{"dataframes": [], "user": "uedamakishi"}', 28: '{"dataframes": [], "user": "uedamakishi"}', 29: '{"dataframes": [], "user": "uedamakishi"}', 31: '{"dataframes": [], "user": "uedamakishi"}', 33: '{"dataframes": [], "user": "uedamakishi"}', 35: '{"dataframes": [], "user": "uedamakishi"}', 37: '{"dataframes": [], "user": "uedamakishi"}'}, 'get_ipython': <bound method InteractiveShell.get_ipython of <ipykernel.zmqshell.ZMQInteractiveShell object at 0x107eb7df0>>, 'exit': <IPython.core.autocall.ZMQExitAutocall object at 0x107f00700>, 'quit': <IPython.core.autocall.ZMQExitAutocall object at 0x107f00700>, 'open': <function open at 0x106c1e830>, '_': '{"dataframes": [], "user": "uedamakishi"}', '__': '{"dataframes": [], "user": "uedamakishi"}', '___': '{"dataframes": [], "user": "uedamakishi"}', '__session__': '/Users/uedamakishi/github/Python_basic/Untitled.ipynb', 'sys': <module 'sys' (built-in)>, 'os': <module 'os' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/os.py'>, 're': <module 're' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/re.py'>, 'json': <module 'json' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/json/__init__.py'>, 'Path': <class 'pathlib.Path'>, 'Annotated': <class 'typing.Annotated'>, 'Any': typing.Any, 'Callable': typing.Callable, 'ClassVar': typing.ClassVar, 'Concatenate': typing.Concatenate, 'Final': typing.Final, 'ForwardRef': <class 'typing.ForwardRef'>, 'Generic': <class 'typing.Generic'>, 'Literal': typing.Literal, 'Optional': typing.Optional, 'ParamSpec': <class 'typing.ParamSpec'>, 'Protocol': <class 'typing.Protocol'>, 'Tuple': typing.Tuple, 'Type': typing.Type, 'TypeVar': <class 'typing.TypeVar'>, 'Union': typing.Union, 'AbstractSet': typing.AbstractSet, 'ByteString': typing.ByteString, 'Container': typing.Container, 'ContextManager': typing.ContextManager, 'Hashable': typing.Hashable, 'ItemsView': typing.ItemsView, 'Iterable': typing.Iterable, 'Iterator': typing.Iterator, 'KeysView': typing.KeysView, 'Mapping': typing.Mapping, 'MappingView': typing.MappingView, 'MutableMapping': typing.MutableMapping, 'MutableSequence': typing.MutableSequence, 'MutableSet': typing.MutableSet, 'Sequence': typing.Sequence, 'Sized': typing.Sized, 'ValuesView': typing.ValuesView, 'Awaitable': typing.Awaitable, 'AsyncIterator': typing.AsyncIterator, 'AsyncIterable': typing.AsyncIterable, 'Coroutine': typing.Coroutine, 'Collection': typing.Collection, 'AsyncGenerator': typing.AsyncGenerator, 'AsyncContextManager': typing.AsyncContextManager, 'Reversible': typing.Reversible, 'SupportsAbs': <class 'typing.SupportsAbs'>, 'SupportsBytes': <class 'typing.SupportsBytes'>, 'SupportsComplex': <class 'typing.SupportsComplex'>, 'SupportsFloat': <class 'typing.SupportsFloat'>, 'SupportsIndex': <class 'typing.SupportsIndex'>, 'SupportsInt': <class 'typing.SupportsInt'>, 'SupportsRound': <class 'typing.SupportsRound'>, 'ChainMap': typing.ChainMap, 'Counter': typing.Counter, 'Deque': typing.Deque, 'Dict': typing.Dict, 'DefaultDict': typing.DefaultDict, 'List': typing.List, 'OrderedDict': typing.OrderedDict, 'Set': typing.Set, 'FrozenSet': typing.FrozenSet, 'NamedTuple': <function NamedTuple at 0x104ad7760>, 'TypedDict': <function TypedDict at 0x104ad7910>, 'Generator': typing.Generator, 'BinaryIO': <class 'typing.BinaryIO'>, 'IO': <class 'typing.IO'>, 'Match': typing.Match, 'Pattern': typing.Pattern, 'TextIO': <class 'typing.TextIO'>, 'AnyStr': ~AnyStr, 'cast': <function cast at 0x104ad6830>, 'final': <function final at 0x104ad6e60>, 'get_args': <function get_args at 0x104ad6b00>, 'get_origin': <function get_origin at 0x104ad6a70>, 'get_type_hints': <function get_type_hints at 0x104ad6950>, 'is_typeddict': <function is_typeddict at 0x104ad6b90>, 'NewType': <class 'typing.NewType'>, 'no_type_check': <function no_type_check at 0x104ad6c20>, 'no_type_check_decorator': <function no_type_check_decorator at 0x104ad6cb0>, 'NoReturn': typing.NoReturn, 'overload': <function overload at 0x104ad6dd0>, 'ParamSpecArgs': <class 'typing.ParamSpecArgs'>, 'ParamSpecKwargs': <class 'typing.ParamSpecKwargs'>, 'runtime_checkable': <function runtime_checkable at 0x104ad5fc0>, 'Text': <class 'str'>, 'TYPE_CHECKING': False, 'TypeAlias': typing.TypeAlias, 'TypeGuard': typing.TypeGuard, 'defaultdict': <class 'collections.defaultdict'>, '__msg': 'Imported sys, os, re, json, Path, defaultdict, and all modules of typing and rhoknp.', '__version__': '1.1.0', 'RegexSenter': <class 'rhoknp.processors.senter.RegexSenter'>, 'Jumanpp': <class 'rhoknp.processors.jumanpp.Jumanpp'>, 'KNP': <class 'rhoknp.processors.knp.KNP'>, 'KWJA': <class 'rhoknp.processors.kwja.KWJA'>, 'Document': <class 'rhoknp.units.document.Document'>, 'Sentence': <class 'rhoknp.units.sentence.Sentence'>, 'Clause': <class 'rhoknp.units.clause.Clause'>, 'Phrase': <class 'rhoknp.units.phrase.Phrase'>, 'BasePhrase': <class 'rhoknp.units.base_phrase.BasePhrase'>, 'Morpheme': <class 'rhoknp.units.morpheme.Morpheme'>, 'readline': <module 'readline' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/lib-dynload/readline.cpython-310-darwin.so'>, 'atexit': <module 'atexit' (built-in)>, '__hist': PosixPath('/Users/uedamakishi/.local/share/python/python_history'), 'write_history': <function write_history at 0x107fcac20>, '_i': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_ii': 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(globals())', '_iii': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_i1': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'getpass': <module 'getpass' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/getpass.py'>, 'hashlib': <module 'hashlib' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/hashlib.py'>, 'import_pandas_safely': <function import_pandas_safely at 0x117502710>, '__pandas': <module 'pandas' from '/opt/homebrew/lib/python3.10/site-packages/pandas/__init__.py'>, 'is_data_frame': <function is_data_frame at 0x1178989d0>, 'dataframe_columns': <function dataframe_columns at 0x117503d90>, 'dtypes_str': <function dtypes_str at 0x1175029e0>, 'dataframe_hash': <function dataframe_hash at 0x117503ac0>, 'get_dataframes': <function get_dataframes at 0x117503c70>, '_1': '{"dataframes": [], "user": "uedamakishi"}', '_i2': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_2': '{"dataframes": [], "user": "uedamakishi"}', '_i3': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_3': '{"dataframes": [], "user": "uedamakishi"}', '_i4': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_4': '{"dataframes": [], "user": "uedamakishi"}', '_i5': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_5': '{"dataframes": [], "user": "uedamakishi"}', '_i6': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_6': '{"dataframes": [], "user": "uedamakishi"}', '_i7': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_7': '{"dataframes": [], "user": "uedamakishi"}', '_i8': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_8': '{"dataframes": [], "user": "uedamakishi"}', '_i9': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_9': '{"dataframes": [], "user": "uedamakishi"}', '_i10': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_10': '{"dataframes": [], "user": "uedamakishi"}', '_i11': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_11': '{"dataframes": [], "user": "uedamakishi"}', '_i12': 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (T < F)\nL = [5, 3.14, "Hello python!", (T < F)]\n\nprint(globals())', 'I': 5, 'F': 3.14, 'St': 'Hello python!', '_i13': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_13': '{"dataframes": [], "user": "uedamakishi"}', '_i14': 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (I < F)\nL = [5, 3.14, "Hello python!", (I < F)]\n\nprint(globals())', 'B_01': False, 'L': [5, 3.14, 'Hello python!', False], '_i15': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_15': '{"dataframes": [], "user": "uedamakishi"}', '_i16': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_16': '{"dataframes": [], "user": "uedamakishi"}', '_i17': 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\nprint(globals())', 'a': 2, 'x': 10, 'exponential': <function exponential at 0x117503a30>, '_i18': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_18': '{"dataframes": [], "user": "uedamakishi"}', '_i19': 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\n\nprint(globals())', '_i20': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_20': '{"dataframes": [], "user": "uedamakishi"}', '_i21': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_21': '{"dataframes": [], "user": "uedamakishi"}', '_i22': 'def greeting():\n    morning = "おはよう"\n\nprint(morning)', 'greeting': <function greeting at 0x117898a60>, '_i23': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_23': '{"dataframes": [], "user": "uedamakishi"}', '_i24': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_24': '{"dataframes": [], "user": "uedamakishi"}', '_i25': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_25': '{"dataframes": [], "user": "uedamakishi"}', '_i26': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_26': '{"dataframes": [], "user": "uedamakishi"}', '_i27': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_27': '{"dataframes": [], "user": "uedamakishi"}', '_i28': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_28': '{"dataframes": [], "user": "uedamakishi"}', '_i29': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_29': '{"dataframes": [], "user": "uedamakishi"}', '_i30': 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(egvening)\n\nprint(egvening)\ngreeting()', 'evening': 'こんばんは', '_i31': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_31': '{"dataframes": [], "user": "uedamakishi"}', '_i32': 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(evening)\ngreeting()', '_i33': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_33': '{"dataframes": [], "user": "uedamakishi"}', '_i34': 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(evening)  # 関数の外から変数eveningを参照\ngreeting()  # 関数の中から変数eveningを参照', '_i35': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_35': '{"dataframes": [], "user": "uedamakishi"}', '_i36': 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(globals())', '_i37': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_37': '{"dataframes": [], "user": "uedamakishi"}', '_i38': 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(globals())  # 関数内で定義した変数morningは表示されない'}


## ローカルスコープ
関数やクラスの中で定義された変数は，その関数やクラスの中からしか参照できない．


```python
# 関数の中で定義された変数を関数の中から参照
def greeting():
    morning = "おはよう"
    print(morning)

greeting()
```

    おはよう



```python
# 関数の中で定義した変数を関数の外から参照しようとするとエラーになる．
def greeting():
    morning = "おはよう"

print(morning)
```


    ---------------------------------------------------------------------------

    NameError                                 Traceback (most recent call last)

    Cell In[45], line 5
          2 def greeting():
          3     morning = "おはよう"
    ----> 5 print(morning)


    NameError: name 'morning' is not defined


ローカルスコープ，グローバルスコープ，ビルトインスコープの順に参照する．
- ローカル変数：ローカルスコープで定義された変数
- グローバル変数：グローバルスコープで定義された変数


```python
morning = "おはよう"

def greeting():
    morning = "おはよう"
    print(morning)  # 関数内で定義された変数morning(ローカルスコープ)を優先的に参照

greeting()
print(morning)  # 関数内で定義された変数morningは参照できないので，同じモジュール内の関数外で定義された変数morningを参照
```

    おはよう
    おはよう



```python
# 関数内で定義された変数morning(ローカルスコープ)を優先的に参照しようとするが，それ以前にprint関数で変数morningを呼び出しているのでエラーになる．
morning = "おはよう"

def greeting():
    print(morning)
    morning = "おはよう"
    
greeting()

```


    ---------------------------------------------------------------------------

    UnboundLocalError                         Traceback (most recent call last)

    Cell In[52], line 8
          5     print(morning)
          6     morning = "おはよう"
    ----> 8 greeting()


    Cell In[52], line 5, in greeting()
          4 def greeting():
    ----> 5     print(morning)
          6     morning = "おはよう"


    UnboundLocalError: local variable 'morning' referenced before assignment


組み込み関数のlocals関数で確認


```python
morning = "おはよう"

def greeting():
    morning = "おはよう"
    print(locals())
    
greeting()

```

    {'morning': 'おはよう'}



```python
morning = "おはよう"

def greeting():
    morning = "おはよう"
    
greeting()
print(locals())  # これはglobals関数を使った場合と同じ結果
```

    {'__name__': '__main__', '__doc__': 'Automatically created module for IPython interactive environment', '__package__': None, '__loader__': None, '__spec__': None, '__builtin__': <module 'builtins' (built-in)>, '__builtins__': <module 'builtins' (built-in)>, '_ih': ['', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (T < F)\nL = [5, 3.14, "Hello python!", (T < F)]\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (I < F)\nL = [5, 3.14, "Hello python!", (I < F)]\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'def greeting():\n    morning = "おはよう"\n\nprint(morning)', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(egvening)\n\nprint(egvening)\ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(evening)\ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(evening)  # 関数の外から変数eveningを参照\ngreeting()  # 関数の中から変数eveningを参照', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(globals())  # 関数内で定義した変数morningは表示されない', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '# 関数の中で定義した変数を関数の外から呼び出そうとするとエラーになる．\ndef greeting():\n    morning = "おはよう"\n\nprint(morning)', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '# 関数の中で定義された変数を関数の中から参照\ndef greeting():\n    morning = "おはよう"\n    print(morning)\n\ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '# 関数の中で定義した変数を関数の外から参照しようとするとエラーになる．\ndef greeting():\n    morning = "おはよう"\n\nprint(morning)', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'morning = "おはよう"\n\ndef greeting():\n    morning = "おはよう"\n    print(morning)  # 関数内で定義された変数morning(ローカルスコープ)を優先的に参照\n\ngreeting()\nprint(morning)  # 関数内で定義された変数morningは参照できないので，同じモジュール内の関数外で定義された変数morningを参照', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '# 関数内で定義された変数morning(ローカルスコープ)を優先的に参照しようとするが，それ以前にprint関数で変数morningを呼び出しているのでエラーになる．\nmorning = "おはよう"\n\ndef greeting():\n    print(morning)\n    morning = "おはよう"\n    \ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '# 関数内で定義された変数morning(ローカルスコープ)を優先的に参照しようとするが，それ以前にprint関数で変数morningを呼び出しているのでエラーになる．\nmorning = "おはよう"\n\ndef greeting():\n    print(morning)\n    morning = "おはよう"\n    \ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'morning = "おはよう"\n\ndef greeting():\n    morning = "おはよう"\n    print(locals())\ngreeting()\nprint(morning)  # 関数内で定義された変数morningは参照できないので，同じモジュール内の関数外で定義された変数morningを参照', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'morning = "おはよう"\n\ndef greeting():\n    morning = "おはよう"\n    print(locals())\n    \ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'morning = "おはよう"\n\ndef greeting():\n    morning = "おはよう"\n    \ngreeting()\nprint(locals())  # これはglobals関数を使った場合と同じ結果'], '_oh': {1: '{"dataframes": [], "user": "uedamakishi"}', 2: '{"dataframes": [], "user": "uedamakishi"}', 3: '{"dataframes": [], "user": "uedamakishi"}', 4: '{"dataframes": [], "user": "uedamakishi"}', 5: '{"dataframes": [], "user": "uedamakishi"}', 6: '{"dataframes": [], "user": "uedamakishi"}', 7: '{"dataframes": [], "user": "uedamakishi"}', 8: '{"dataframes": [], "user": "uedamakishi"}', 9: '{"dataframes": [], "user": "uedamakishi"}', 10: '{"dataframes": [], "user": "uedamakishi"}', 11: '{"dataframes": [], "user": "uedamakishi"}', 13: '{"dataframes": [], "user": "uedamakishi"}', 15: '{"dataframes": [], "user": "uedamakishi"}', 16: '{"dataframes": [], "user": "uedamakishi"}', 18: '{"dataframes": [], "user": "uedamakishi"}', 20: '{"dataframes": [], "user": "uedamakishi"}', 21: '{"dataframes": [], "user": "uedamakishi"}', 23: '{"dataframes": [], "user": "uedamakishi"}', 24: '{"dataframes": [], "user": "uedamakishi"}', 25: '{"dataframes": [], "user": "uedamakishi"}', 26: '{"dataframes": [], "user": "uedamakishi"}', 27: '{"dataframes": [], "user": "uedamakishi"}', 28: '{"dataframes": [], "user": "uedamakishi"}', 29: '{"dataframes": [], "user": "uedamakishi"}', 31: '{"dataframes": [], "user": "uedamakishi"}', 33: '{"dataframes": [], "user": "uedamakishi"}', 35: '{"dataframes": [], "user": "uedamakishi"}', 37: '{"dataframes": [], "user": "uedamakishi"}', 39: '{"dataframes": [], "user": "uedamakishi"}', 40: '{"dataframes": [], "user": "uedamakishi"}', 42: '{"dataframes": [], "user": "uedamakishi"}', 44: '{"dataframes": [], "user": "uedamakishi"}', 46: '{"dataframes": [], "user": "uedamakishi"}', 48: '{"dataframes": [], "user": "uedamakishi"}', 49: '{"dataframes": [], "user": "uedamakishi"}', 51: '{"dataframes": [], "user": "uedamakishi"}', 53: '{"dataframes": [], "user": "uedamakishi"}', 54: '{"dataframes": [], "user": "uedamakishi"}', 56: '{"dataframes": [], "user": "uedamakishi"}', 58: '{"dataframes": [], "user": "uedamakishi"}'}, '_dh': [PosixPath('/Users/uedamakishi/github/Python_basic')], 'In': ['', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (T < F)\nL = [5, 3.14, "Hello python!", (T < F)]\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (I < F)\nL = [5, 3.14, "Hello python!", (I < F)]\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'def greeting():\n    morning = "おはよう"\n\nprint(morning)', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(egvening)\n\nprint(egvening)\ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(evening)\ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(evening)  # 関数の外から変数eveningを参照\ngreeting()  # 関数の中から変数eveningを参照', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(globals())', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(globals())  # 関数内で定義した変数morningは表示されない', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '# 関数の中で定義した変数を関数の外から呼び出そうとするとエラーになる．\ndef greeting():\n    morning = "おはよう"\n\nprint(morning)', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '# 関数の中で定義された変数を関数の中から参照\ndef greeting():\n    morning = "おはよう"\n    print(morning)\n\ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '# 関数の中で定義した変数を関数の外から参照しようとするとエラーになる．\ndef greeting():\n    morning = "おはよう"\n\nprint(morning)', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'morning = "おはよう"\n\ndef greeting():\n    morning = "おはよう"\n    print(morning)  # 関数内で定義された変数morning(ローカルスコープ)を優先的に参照\n\ngreeting()\nprint(morning)  # 関数内で定義された変数morningは参照できないので，同じモジュール内の関数外で定義された変数morningを参照', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '# 関数内で定義された変数morning(ローカルスコープ)を優先的に参照しようとするが，それ以前にprint関数で変数morningを呼び出しているのでエラーになる．\nmorning = "おはよう"\n\ndef greeting():\n    print(morning)\n    morning = "おはよう"\n    \ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '# 関数内で定義された変数morning(ローカルスコープ)を優先的に参照しようとするが，それ以前にprint関数で変数morningを呼び出しているのでエラーになる．\nmorning = "おはよう"\n\ndef greeting():\n    print(morning)\n    morning = "おはよう"\n    \ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'morning = "おはよう"\n\ndef greeting():\n    morning = "おはよう"\n    print(locals())\ngreeting()\nprint(morning)  # 関数内で定義された変数morningは参照できないので，同じモジュール内の関数外で定義された変数morningを参照', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'morning = "おはよう"\n\ndef greeting():\n    morning = "おはよう"\n    print(locals())\n    \ngreeting()', 'import json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = get_ipython().run_line_magic(\'who_ls\', \'\')\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'morning = "おはよう"\n\ndef greeting():\n    morning = "おはよう"\n    \ngreeting()\nprint(locals())  # これはglobals関数を使った場合と同じ結果'], 'Out': {1: '{"dataframes": [], "user": "uedamakishi"}', 2: '{"dataframes": [], "user": "uedamakishi"}', 3: '{"dataframes": [], "user": "uedamakishi"}', 4: '{"dataframes": [], "user": "uedamakishi"}', 5: '{"dataframes": [], "user": "uedamakishi"}', 6: '{"dataframes": [], "user": "uedamakishi"}', 7: '{"dataframes": [], "user": "uedamakishi"}', 8: '{"dataframes": [], "user": "uedamakishi"}', 9: '{"dataframes": [], "user": "uedamakishi"}', 10: '{"dataframes": [], "user": "uedamakishi"}', 11: '{"dataframes": [], "user": "uedamakishi"}', 13: '{"dataframes": [], "user": "uedamakishi"}', 15: '{"dataframes": [], "user": "uedamakishi"}', 16: '{"dataframes": [], "user": "uedamakishi"}', 18: '{"dataframes": [], "user": "uedamakishi"}', 20: '{"dataframes": [], "user": "uedamakishi"}', 21: '{"dataframes": [], "user": "uedamakishi"}', 23: '{"dataframes": [], "user": "uedamakishi"}', 24: '{"dataframes": [], "user": "uedamakishi"}', 25: '{"dataframes": [], "user": "uedamakishi"}', 26: '{"dataframes": [], "user": "uedamakishi"}', 27: '{"dataframes": [], "user": "uedamakishi"}', 28: '{"dataframes": [], "user": "uedamakishi"}', 29: '{"dataframes": [], "user": "uedamakishi"}', 31: '{"dataframes": [], "user": "uedamakishi"}', 33: '{"dataframes": [], "user": "uedamakishi"}', 35: '{"dataframes": [], "user": "uedamakishi"}', 37: '{"dataframes": [], "user": "uedamakishi"}', 39: '{"dataframes": [], "user": "uedamakishi"}', 40: '{"dataframes": [], "user": "uedamakishi"}', 42: '{"dataframes": [], "user": "uedamakishi"}', 44: '{"dataframes": [], "user": "uedamakishi"}', 46: '{"dataframes": [], "user": "uedamakishi"}', 48: '{"dataframes": [], "user": "uedamakishi"}', 49: '{"dataframes": [], "user": "uedamakishi"}', 51: '{"dataframes": [], "user": "uedamakishi"}', 53: '{"dataframes": [], "user": "uedamakishi"}', 54: '{"dataframes": [], "user": "uedamakishi"}', 56: '{"dataframes": [], "user": "uedamakishi"}', 58: '{"dataframes": [], "user": "uedamakishi"}'}, 'get_ipython': <bound method InteractiveShell.get_ipython of <ipykernel.zmqshell.ZMQInteractiveShell object at 0x107eb7df0>>, 'exit': <IPython.core.autocall.ZMQExitAutocall object at 0x107f00700>, 'quit': <IPython.core.autocall.ZMQExitAutocall object at 0x107f00700>, 'open': <function open at 0x106c1e830>, '_': '{"dataframes": [], "user": "uedamakishi"}', '__': '{"dataframes": [], "user": "uedamakishi"}', '___': '{"dataframes": [], "user": "uedamakishi"}', '__session__': '/Users/uedamakishi/github/Python_basic/Untitled.ipynb', 'sys': <module 'sys' (built-in)>, 'os': <module 'os' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/os.py'>, 're': <module 're' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/re.py'>, 'json': <module 'json' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/json/__init__.py'>, 'Path': <class 'pathlib.Path'>, 'Annotated': <class 'typing.Annotated'>, 'Any': typing.Any, 'Callable': typing.Callable, 'ClassVar': typing.ClassVar, 'Concatenate': typing.Concatenate, 'Final': typing.Final, 'ForwardRef': <class 'typing.ForwardRef'>, 'Generic': <class 'typing.Generic'>, 'Literal': typing.Literal, 'Optional': typing.Optional, 'ParamSpec': <class 'typing.ParamSpec'>, 'Protocol': <class 'typing.Protocol'>, 'Tuple': typing.Tuple, 'Type': typing.Type, 'TypeVar': <class 'typing.TypeVar'>, 'Union': typing.Union, 'AbstractSet': typing.AbstractSet, 'ByteString': typing.ByteString, 'Container': typing.Container, 'ContextManager': typing.ContextManager, 'Hashable': typing.Hashable, 'ItemsView': typing.ItemsView, 'Iterable': typing.Iterable, 'Iterator': typing.Iterator, 'KeysView': typing.KeysView, 'Mapping': typing.Mapping, 'MappingView': typing.MappingView, 'MutableMapping': typing.MutableMapping, 'MutableSequence': typing.MutableSequence, 'MutableSet': typing.MutableSet, 'Sequence': typing.Sequence, 'Sized': typing.Sized, 'ValuesView': typing.ValuesView, 'Awaitable': typing.Awaitable, 'AsyncIterator': typing.AsyncIterator, 'AsyncIterable': typing.AsyncIterable, 'Coroutine': typing.Coroutine, 'Collection': typing.Collection, 'AsyncGenerator': typing.AsyncGenerator, 'AsyncContextManager': typing.AsyncContextManager, 'Reversible': typing.Reversible, 'SupportsAbs': <class 'typing.SupportsAbs'>, 'SupportsBytes': <class 'typing.SupportsBytes'>, 'SupportsComplex': <class 'typing.SupportsComplex'>, 'SupportsFloat': <class 'typing.SupportsFloat'>, 'SupportsIndex': <class 'typing.SupportsIndex'>, 'SupportsInt': <class 'typing.SupportsInt'>, 'SupportsRound': <class 'typing.SupportsRound'>, 'ChainMap': typing.ChainMap, 'Counter': typing.Counter, 'Deque': typing.Deque, 'Dict': typing.Dict, 'DefaultDict': typing.DefaultDict, 'List': typing.List, 'OrderedDict': typing.OrderedDict, 'Set': typing.Set, 'FrozenSet': typing.FrozenSet, 'NamedTuple': <function NamedTuple at 0x104ad7760>, 'TypedDict': <function TypedDict at 0x104ad7910>, 'Generator': typing.Generator, 'BinaryIO': <class 'typing.BinaryIO'>, 'IO': <class 'typing.IO'>, 'Match': typing.Match, 'Pattern': typing.Pattern, 'TextIO': <class 'typing.TextIO'>, 'AnyStr': ~AnyStr, 'cast': <function cast at 0x104ad6830>, 'final': <function final at 0x104ad6e60>, 'get_args': <function get_args at 0x104ad6b00>, 'get_origin': <function get_origin at 0x104ad6a70>, 'get_type_hints': <function get_type_hints at 0x104ad6950>, 'is_typeddict': <function is_typeddict at 0x104ad6b90>, 'NewType': <class 'typing.NewType'>, 'no_type_check': <function no_type_check at 0x104ad6c20>, 'no_type_check_decorator': <function no_type_check_decorator at 0x104ad6cb0>, 'NoReturn': typing.NoReturn, 'overload': <function overload at 0x104ad6dd0>, 'ParamSpecArgs': <class 'typing.ParamSpecArgs'>, 'ParamSpecKwargs': <class 'typing.ParamSpecKwargs'>, 'runtime_checkable': <function runtime_checkable at 0x104ad5fc0>, 'Text': <class 'str'>, 'TYPE_CHECKING': False, 'TypeAlias': typing.TypeAlias, 'TypeGuard': typing.TypeGuard, 'defaultdict': <class 'collections.defaultdict'>, '__msg': 'Imported sys, os, re, json, Path, defaultdict, and all modules of typing and rhoknp.', '__version__': '1.1.0', 'RegexSenter': <class 'rhoknp.processors.senter.RegexSenter'>, 'Jumanpp': <class 'rhoknp.processors.jumanpp.Jumanpp'>, 'KNP': <class 'rhoknp.processors.knp.KNP'>, 'KWJA': <class 'rhoknp.processors.kwja.KWJA'>, 'Document': <class 'rhoknp.units.document.Document'>, 'Sentence': <class 'rhoknp.units.sentence.Sentence'>, 'Clause': <class 'rhoknp.units.clause.Clause'>, 'Phrase': <class 'rhoknp.units.phrase.Phrase'>, 'BasePhrase': <class 'rhoknp.units.base_phrase.BasePhrase'>, 'Morpheme': <class 'rhoknp.units.morpheme.Morpheme'>, 'readline': <module 'readline' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/lib-dynload/readline.cpython-310-darwin.so'>, 'atexit': <module 'atexit' (built-in)>, '__hist': PosixPath('/Users/uedamakishi/.local/share/python/python_history'), 'write_history': <function write_history at 0x107fcac20>, '_i': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_ii': 'morning = "おはよう"\n\ndef greeting():\n    morning = "おはよう"\n    print(locals())\n    \ngreeting()', '_iii': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_i1': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', 'getpass': <module 'getpass' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/getpass.py'>, 'hashlib': <module 'hashlib' from '/opt/homebrew/Cellar/python@3.10/3.10.9/Frameworks/Python.framework/Versions/3.10/lib/python3.10/hashlib.py'>, 'import_pandas_safely': <function import_pandas_safely at 0x1175024d0>, '__pandas': <module 'pandas' from '/opt/homebrew/lib/python3.10/site-packages/pandas/__init__.py'>, 'is_data_frame': <function is_data_frame at 0x107fcb400>, 'dataframe_columns': <function dataframe_columns at 0x1175015a0>, 'dtypes_str': <function dtypes_str at 0x117503d90>, 'dataframe_hash': <function dataframe_hash at 0x117501480>, 'get_dataframes': <function get_dataframes at 0x117500e50>, '_1': '{"dataframes": [], "user": "uedamakishi"}', '_i2': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_2': '{"dataframes": [], "user": "uedamakishi"}', '_i3': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_3': '{"dataframes": [], "user": "uedamakishi"}', '_i4': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_4': '{"dataframes": [], "user": "uedamakishi"}', '_i5': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_5': '{"dataframes": [], "user": "uedamakishi"}', '_i6': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_6': '{"dataframes": [], "user": "uedamakishi"}', '_i7': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_7': '{"dataframes": [], "user": "uedamakishi"}', '_i8': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_8': '{"dataframes": [], "user": "uedamakishi"}', '_i9': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_9': '{"dataframes": [], "user": "uedamakishi"}', '_i10': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_10': '{"dataframes": [], "user": "uedamakishi"}', '_i11': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_11': '{"dataframes": [], "user": "uedamakishi"}', '_i12': 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (T < F)\nL = [5, 3.14, "Hello python!", (T < F)]\n\nprint(globals())', 'I': 5, 'F': 3.14, 'St': 'Hello python!', '_i13': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_13': '{"dataframes": [], "user": "uedamakishi"}', '_i14': 'I = 5\nF = 3.14\nSt = "Hello python!"\nB_01 = (I < F)\nL = [5, 3.14, "Hello python!", (I < F)]\n\nprint(globals())', 'B_01': False, 'L': [5, 3.14, 'Hello python!', False], '_i15': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_15': '{"dataframes": [], "user": "uedamakishi"}', '_i16': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_16': '{"dataframes": [], "user": "uedamakishi"}', '_i17': 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\nprint(globals())', 'a': 2, 'x': 10, 'exponential': <function exponential at 0x117503a30>, '_i18': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_18': '{"dataframes": [], "user": "uedamakishi"}', '_i19': 'a = 2\nx = 10\n\ndef exponential(a, x):\n    return a ** x\n\nprint(globals())', '_i20': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_20': '{"dataframes": [], "user": "uedamakishi"}', '_i21': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_21': '{"dataframes": [], "user": "uedamakishi"}', '_i22': 'def greeting():\n    morning = "おはよう"\n\nprint(morning)', 'greeting': <function greeting at 0x1175029e0>, '_i23': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_23': '{"dataframes": [], "user": "uedamakishi"}', '_i24': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_24': '{"dataframes": [], "user": "uedamakishi"}', '_i25': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_25': '{"dataframes": [], "user": "uedamakishi"}', '_i26': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_26': '{"dataframes": [], "user": "uedamakishi"}', '_i27': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_27': '{"dataframes": [], "user": "uedamakishi"}', '_i28': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_28': '{"dataframes": [], "user": "uedamakishi"}', '_i29': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_29': '{"dataframes": [], "user": "uedamakishi"}', '_i30': 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(egvening)\n\nprint(egvening)\ngreeting()', 'evening': 'こんばんは', '_i31': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_31': '{"dataframes": [], "user": "uedamakishi"}', '_i32': 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(evening)\ngreeting()', '_i33': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_33': '{"dataframes": [], "user": "uedamakishi"}', '_i34': 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(evening)  # 関数の外から変数eveningを参照\ngreeting()  # 関数の中から変数eveningを参照', '_i35': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_35': '{"dataframes": [], "user": "uedamakishi"}', '_i36': 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(globals())', '_i37': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_37': '{"dataframes": [], "user": "uedamakishi"}', '_i38': 'evening = "こんばんは"\n\ndef greeting():\n    morning = "おはよう"\n    print(evening)\n\nprint(globals())  # 関数内で定義した変数morningは表示されない', '_i39': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_39': '{"dataframes": [], "user": "uedamakishi"}', '_i40': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_40': '{"dataframes": [], "user": "uedamakishi"}', '_i41': '# 関数の中で定義した変数を関数の外から呼び出そうとするとエラーになる．\ndef greeting():\n    morning = "おはよう"\n\nprint(morning)', '_i42': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_42': '{"dataframes": [], "user": "uedamakishi"}', '_i43': '# 関数の中で定義された変数を関数の中から参照\ndef greeting():\n    morning = "おはよう"\n    print(morning)\n\ngreeting()', '_i44': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_44': '{"dataframes": [], "user": "uedamakishi"}', '_i45': '# 関数の中で定義した変数を関数の外から参照しようとするとエラーになる．\ndef greeting():\n    morning = "おはよう"\n\nprint(morning)', '_i46': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_46': '{"dataframes": [], "user": "uedamakishi"}', '_i47': 'morning = "おはよう"\n\ndef greeting():\n    morning = "おはよう"\n    print(morning)  # 関数内で定義された変数morning(ローカルスコープ)を優先的に参照\n\ngreeting()\nprint(morning)  # 関数内で定義された変数morningは参照できないので，同じモジュール内の関数外で定義された変数morningを参照', 'morning': 'おはよう', '_i48': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_48': '{"dataframes": [], "user": "uedamakishi"}', '_i49': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_49': '{"dataframes": [], "user": "uedamakishi"}', '_i50': '# 関数内で定義された変数morning(ローカルスコープ)を優先的に参照しようとするが，それ以前にprint関数で変数morningを呼び出しているのでエラーになる．\nmorning = "おはよう"\n\ndef greeting():\n    print(morning)\n    morning = "おはよう"\n    \ngreeting()', '_i51': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_51': '{"dataframes": [], "user": "uedamakishi"}', '_i52': '# 関数内で定義された変数morning(ローカルスコープ)を優先的に参照しようとするが，それ以前にprint関数で変数morningを呼び出しているのでエラーになる．\nmorning = "おはよう"\n\ndef greeting():\n    print(morning)\n    morning = "おはよう"\n    \ngreeting()', '_i53': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_53': '{"dataframes": [], "user": "uedamakishi"}', '_i54': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_54': '{"dataframes": [], "user": "uedamakishi"}', '_i55': 'morning = "おはよう"\n\ndef greeting():\n    morning = "おはよう"\n    print(locals())\ngreeting()\nprint(morning)  # 関数内で定義された変数morningは参照できないので，同じモジュール内の関数外で定義された変数morningを参照', '_i56': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_56': '{"dataframes": [], "user": "uedamakishi"}', '_i57': 'morning = "おはよう"\n\ndef greeting():\n    morning = "おはよう"\n    print(locals())\n    \ngreeting()', '_i58': '\nimport json\nimport getpass\nimport hashlib\n\ndef import_pandas_safely():\n    try:\n        return __import__(\'pandas\')\n    except ImportError:\n        return False\n\n\n__pandas = import_pandas_safely()\n\n\ndef is_data_frame(v: str):\n    obj = eval(v)\n    if  isinstance(obj, __pandas.core.frame.DataFrame) or isinstance(obj, __pandas.core.series.Series):\n        return True\n\n\ndef dataframe_columns(var):\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return [[df.name, str(df.dtype)]]\n    return list(map(lambda col: [col, str(df[col].dtype)], df.columns))\n\n\ndef dtypes_str(frame):\n    return str(eval(frame).dtypes)\n\ndef dataframe_hash(var):\n    # Return a hash including the column names and number of rows\n    df = eval(var)\n    if isinstance(df, __pandas.core.series.Series):\n        return hashlib.sha256(f"{var}-{df.name},{len(df)}".encode(\'utf-8\')).hexdigest()\n    return hashlib.sha256(f"{var}-{\',\'.join(df.columns)},{len(df)}".encode(\'utf-8\')).hexdigest()\n\ndef get_dataframes():\n    if __pandas is None:\n        return []\n    user = getpass.getuser()\n    values = %who_ls\n    dataframes = [\n        {\n            "name": var,\n            "type": type(eval(var)).__name__,\n            "hash": dataframe_hash(var),\n            "cols": dataframe_columns(var),\n            "dtypesStr": dtypes_str(var),\n        }\n        for var in values if is_data_frame(var)\n    ]\n    result = {"dataframes": dataframes, "user": user}\n    return json.dumps(result, ensure_ascii=False)\n\n\nget_dataframes()', '_58': '{"dataframes": [], "user": "uedamakishi"}', '_i59': 'morning = "おはよう"\n\ndef greeting():\n    morning = "おはよう"\n    \ngreeting()\nprint(locals())  # これはglobals関数を使った場合と同じ結果'}


## global文
ローカルスコープで定義した変数をグローバル変数として宣言することができる．


```python
def greeting():
    global morning
    morning = "おはよう"

print(morning)
```

    おはよう


## nonlocal文
1つ外側のスコープの変数として宣言することができる．\
ただし，1つ外側がグローバルスコープである場合は使用できない．


```python
morning = "おっはー！"

def greeting1():
    morning = "おはよう"

    def greeting2():
        morning = "おはようございます"
        print(morning)  # 関数greeting2内の変数morningを参照

    greeting2()
    print(morning)  # 関数greeting1内の変数morningを参照

greeting1()
print(morning)  # 関数greeting1外の変数morningを参照
```

    おはようございます
    おはよう
    おっはー！



```python
morning = "おっはー！"

def greeting1():
    morning = "おはよう"

    def greeting2():
        nonlocal morning
        morning = "おはようございます"
        print(morning)  # 関数greeting2内の変数morningを参照

    greeting2()
    print(morning)  # 関数greeting2内の変数morningを参照

greeting1()
print(morning)  # 関数greeting1外の変数morningを参照
```

    おはようございます
    おはようございます
    おっはー！



```python
morning = "おっはー！"

def greeting1():
    morning = "おはよう"

    def greeting2():
        global morning
        morning = "おはようございます"
        print(morning)  # 関数greeting2内の変数morningを参照

    greeting2()
    print(morning)  # 関数greeting1内の変数morningを参照

greeting1()
print(morning)  # 関数greeting2内の変数morningを参照
```

    おはようございます
    おはよう
    おはようございます



```python
# これはエラーになる
morning = "おっはー！"

def greeting1():
    nonlocal morning
    morning = "おはよう"

    def greeting2():
        morning = "おはようございます"
        print(morning)  # 関数greeting2内の変数morningを参照

    greeting2()
    print(morning)  # 関数greeting2内の変数morningを参照

greeting1()
print(morning)  # 関数greeting1外の変数morningを参照
```


      Cell In[85], line 5
        nonlocal morning
        ^
    SyntaxError: no binding for nonlocal 'morning' found



参考：以上はキノコードさん([[ブログ](https://kino-code.com/)・[You Tube](https://youtube.com/@kinocode?si=B4f5QLuWVA9U65uI]))のYou Tube動画を見て勉強した内容をまとめたものです．
